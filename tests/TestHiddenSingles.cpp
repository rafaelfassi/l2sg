#include "Test.h"

bool test(const std::string &puzzle, const std::string &board, const std::string &expectedBoard)
{
    Grid grid;
    grid.fillFromSolutionGrid(board);

    solver::techniques::hiddenSingles(grid);

    return checkAll(puzzle, grid, board, expectedBoard);
}

int main(int, char **)
{
    // Hidden Single in row for value 5 at: (1,6)
    if (!test(".....14.2..1....9.98.452...1...49.3.794...165.3.51..4....17..24.1....6..8.23.....",
              R"(
                .-----------------.------------------.-----------------.
                | 356  567   3567 | 6789  3689  1    | 4     578  2    |
                | 24   24    1    | 678   368   3678 | 3578  9    3678 |
                | 9    8     367  | 4     5     2    | 37    17   1367 |
                :-----------------+------------------+-----------------:
                | 1    256   568  | 67    4     9    | 278   3    78   |
                | 7    9     4    | 28    238   38   | 1     6    5    |
                | 26   3     68   | 5     1     67   | 2789  4    789  |
                :-----------------+------------------+-----------------:
                | 356  56    3569 | 1     7     568  | 3589  2    4    |
                | 345  1     3579 | 289   289   458  | 6     578  3789 |
                | 8    4567  2    | 3     69    456  | 579   157  179  |
                '-----------------'------------------'-----------------'
              )",
              R"(
                .-----------------.------------------.-----------------.
                | 356  567   3567 | 6789  3689  1    | 4     78   2    |
                | 24   24    1    | 678   368   3678 | 5     9    3678 |
                | 9    8     367  | 4     5     2    | 37    17   1367 |
                :-----------------+------------------+-----------------:
                | 1    256   568  | 67    4     9    | 278   3    78   |
                | 7    9     4    | 28    238   38   | 1     6    5    |
                | 26   3     68   | 5     1     67   | 2789  4    789  |
                :-----------------+------------------+-----------------:
                | 356  56    3569 | 1     7     568  | 389   2    4    |
                | 345  1     3579 | 289   289   458  | 6     578  3789 |
                | 8    4567  2    | 3     69    456  | 79    157  179  |
                '-----------------'------------------'-----------------'
              )"))
        return failed();

    // Hidden Single in column for value 5 at: (8,1)
    if (!test(".7.......96.78..414...69.5779......33..6.7..55.6.9.724.3745...924..38576....7.43.",
              R"(
                .-----------------.------------------.--------------.
                | 18   7    12358 | 1235  124  12345 | 69   69   28 |
                | 9    6    235   | 7     8    235   | 23   4    1  |
                | 4    128  1238  | 123   6    9     | 238  5    7  |
                :-----------------+------------------+--------------:
                | 7    9    1248  | 1258  124  1245  | 168  168  3  |
                | 3    128  1248  | 6     124  7     | 189  189  5  |
                | 5    18   6     | 138   9    13    | 7    2    4  |
                :-----------------+------------------+--------------:
                | 68   3    7     | 4     5    26    | 128  18   9  |
                | 2    4    19    | 19    3    8     | 5    7    6  |
                | 168  158  1589  | 129   7    126   | 4    3    28 |
                '-----------------'------------------'--------------'
              )",
              R"(
                .-----------------.------------------.--------------.
                | 18   7    12358 | 1235  124  12345 | 69   69   28 |
                | 9    6    235   | 7     8    235   | 23   4    1  |
                | 4    128  1238  | 123   6    9     | 238  5    7  |
                :-----------------+------------------+--------------:
                | 7    9    1248  | 1258  124  1245  | 168  168  3  |
                | 3    128  1248  | 6     124  7     | 189  189  5  |
                | 5    18   6     | 138   9    13    | 7    2    4  |
                :-----------------+------------------+--------------:
                | 68   3    7     | 4     5    26    | 128  18   9  |
                | 2    4    19    | 19    3    8     | 5    7    6  |
                | 168  5    189   | 129   7    126   | 4    3    28 |
                '-----------------'------------------'--------------'
              )"))
        return failed();

    // Hidden Single in block for value 5 at: (8,7)
    if (!test("8.234.6973.6.27..1..7..6.3..8963.71516..79..37.3...469.3.16.97.9.175.3.667..931..",
              R"(
                .----------------.---------------.----------------.
                | 8    15    2   | 3     4   15  | 6    9     7   |
                | 3    459   6   | 589   2   7   | 58   458   1   |
                | 45   1459  7   | 589   18  6   | 258  3     248 |
                :----------------+---------------+----------------:
                | 24   8     9   | 6     3   24  | 7    1     5   |
                | 1    6     45  | 2458  7   9   | 28   28    3   |
                | 7    25    3   | 258   18  15  | 4    6     9   |
                :----------------+---------------+----------------:
                | 245  3     458 | 1     6   248 | 9    7     48  |
                | 9    24    1   | 7     5   48  | 3    248   6   |
                | 6    7     458 | 24    9   3   | 1    2458  248 |
                '----------------'---------------'----------------'
              )",
              R"(
                .----------------.---------------.---------------.
                | 8    15    2   | 3     4   15  | 6    9    7   |
                | 3    459   6   | 589   2   7   | 58   48   1   |
                | 45   1459  7   | 589   18  6   | 258  3    248 |
                :----------------+---------------+---------------:
                | 24   8     9   | 6     3   24  | 7    1    5   |
                | 1    6     45  | 2458  7   9   | 28   28   3   |
                | 7    25    3   | 258   18  15  | 4    6    9   |
                :----------------+---------------+---------------:
                | 245  3     458 | 1     6   248 | 9    7    48  |
                | 9    24    1   | 7     5   48  | 3    248  6   |
                | 6    7     48  | 24    9   3   | 1    5    248 |
                '----------------'---------------'---------------'
              )"))
        return failed();

    // Hidden Single in row and block for value 9 at: (1,2)
    if (!test(".23.79168......742.....29352.13548.6.369284.....7162.33.26..5...1....62..6524.38.",
              R"(
                .-----------------.--------------.-------------.
                | 45    2    3    | 45   7    9  | 1  6    8   |
                | 16    58   89   | 158  368  35 | 7  4    2   |
                | 16    478  478  | 148  68   2  | 9  3    5   |
                :-----------------+--------------+-------------:
                | 2     79   1    | 3    5    4  | 8  79   6   |
                | 57    3    6    | 9    2    8  | 4  157  17  |
                | 489   459  48   | 7    1    6  | 2  59   3   |
                :-----------------+--------------+-------------:
                | 3     48   2    | 6    89   17 | 5  17   49  |
                | 4789  1    4789 | 58   389  35 | 6  2    479 |
                | 79    6    5    | 2    4    17 | 3  8    179 |
                '-----------------'--------------'-------------'
              )",
              R"(
                .----------------.--------------.-------------.
                | 45    2    3   | 45   7    9  | 1  6    8   |
                | 16    58   9   | 158  368  35 | 7  4    2   |
                | 16    478  478 | 148  68   2  | 9  3    5   |
                :----------------+--------------+-------------:
                | 2     79   1   | 3    5    4  | 8  79   6   |
                | 57    3    6   | 9    2    8  | 4  157  17  |
                | 489   459  48  | 7    1    6  | 2  59   3   |
                :----------------+--------------+-------------:
                | 3     48   2   | 6    89   17 | 5  17   49  |
                | 4789  1    478 | 58   389  35 | 6  2    479 |
                | 79    6    5   | 2    4    17 | 3  8    179 |
                '----------------'--------------'-------------'
              )"))
        return failed();

    // Hidden Single in row, column and block for value 9 at: (7,2)
    if (!test("98.7..6....7.5..49.....9...3..9......9..8.2....8..5.97.1..4.9....95...84....9....",
              R"(
                .------------------------.-----------------------.----------------------.
                | 9       8       12345  | 7       123    1234   | 6      1235    1235  |
                | 126     236     7      | 12368   5      12368  | 138    4       9     |
                | 12456   23456   123456 | 123468  1236   9      | 13578  12357   12358 |
                :------------------------+-----------------------+----------------------:
                | 3       24567   12456  | 9       1267   12467  | 1458   156     1568  |
                | 14567   9       1456   | 1346    8      13467  | 2      1356    1356  |
                | 1246    246     8      | 12346   1236   5      | 134    9       7     |
                :------------------------+-----------------------+----------------------:
                | 25678   1       2356   | 2368    4      23678  | 9      23567   2356  |
                | 267     2367    2369   | 5       12367  12367  | 137    8       4     |
                | 245678  234567  23456  | 12368   9      123678 | 1357   123567  12356 |
                '------------------------'-----------------------'----------------------'
              )",
              R"(
                .------------------------.-----------------------.----------------------.
                | 9       8       12345  | 7       123    1234   | 6      1235    1235  |
                | 126     236     7      | 12368   5      12368  | 138    4       9     |
                | 12456   23456   123456 | 123468  1236   9      | 13578  12357   12358 |
                :------------------------+-----------------------+----------------------:
                | 3       24567   12456  | 9       1267   12467  | 1458   156     1568  |
                | 14567   9       1456   | 1346    8      13467  | 2      1356    1356  |
                | 1246    246     8      | 12346   1236   5      | 134    9       7     |
                :------------------------+-----------------------+----------------------:
                | 25678   1       2356   | 2368    4      23678  | 9      23567   2356  |
                | 267     2367    9      | 5       12367  12367  | 137    8       4     |
                | 245678  234567  23456  | 12368   9      123678 | 1357   123567  12356 |
                '------------------------'-----------------------'----------------------'
              )"))
        return failed();

    return passed();
}